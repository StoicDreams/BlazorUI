@inherits TransitionableLayoutComponent
@using BlazorTransitionableRoute

<main class="@TransitioningClass">
	<ErrorBoundary @ref="ErrorFragment" Context="error">
		<ChildContent>
			@Body
		</ChildContent>
		<ErrorContent>
			<BUIError Exception="@error" />
		</ErrorContent>
	</ErrorBoundary>
</main>

@code {
	private string TransitioningDirection => this.Transition.Backwards ? "Up" : "Down";
	private string TransitioningClass => Transition.FirstRender ? "" : $"{TransitioningEffect()} animate__faster animate__animated";

	private ErrorBoundary? ErrorFragment { get; set; }

	protected override void OnParametersSet()
	{
		ErrorFragment?.Recover();
		base.OnParametersSet();
	}

	private string TransitioningEffect()
	{
		Type transitionFromType = TransitionType.fromType;
		Type transitionToType = TransitionType.toType;
		string effect = Transition.IntoView ? "fadeIn" : "fadeOut";
		string direction = Transition.Backwards ? "Up" : "Down";
		return $"animate__{effect}{direction}{(Transition.IntoView ? " inview" : string.Empty)}";
	}
}